<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Product Details</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      /* styles remain unchanged except minor button positioning below */

      body {
        font-family: "Poppins", sans-serif;
        background-color: #f9f9f9;
        margin: 0;
        padding: 0;
      }

      header {
        background: #111;
        color: white;
        padding: 20px;
        text-align: center;
        position: relative;
      }

      header a.back-link {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        color: white;
        text-decoration: none;
        font-weight: 500;
      }

      .floating-cart {
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        background: white;
        color: #111;
        padding: 10px 14px;
        border-radius: 30px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        text-decoration: none;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: background 0.3s ease;
      }

      .floating-cart.animate {
        animation: bounce 0.4s ease;
      }

      .cart-badge {
        background: red;
        color: white;
        border-radius: 12px;
        padding: 2px 8px;
        font-size: 12px;
        font-weight: bold;
      }

      @keyframes bounce {
        0% {
          transform: translateY(-50%) scale(1);
        }
        50% {
          transform: translateY(-55%) scale(1.2);
        }
        100% {
          transform: translateY(-50%) scale(1);
        }
      }

      .product-container {
        display: flex;
        flex-wrap: wrap;
        gap: 40px;
        max-width: 1100px;
        margin: 40px auto;
        padding: 30px;
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 5px 25px rgba(0, 0, 0, 0.08);
      }

      .product-images {
        flex: 1;
        min-width: 300px;
      }

      .main-image {
        width: 100%;
        max-width: 450px;
        border-radius: 10px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        margin-bottom: 10px;
        transition: transform 0.3s ease;
      }

      .main-image:hover {
        transform: scale(1.05);
        cursor: zoom-in;
      }

      .thumbnail-row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .thumbnail-row img {
        width: 70px;
        height: 70px;
        object-fit: cover;
        border-radius: 6px;
        cursor: pointer;
        border: 2px solid transparent;
        transition: 0.2s;
      }

      .thumbnail-row img:hover,
      .thumbnail-row img.active {
        border-color: #111;
      }

      .slideshow-wrapper {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(17, 17, 17, 0.6);
        color: white;
        border: none;
        padding: 8px 12px;
        font-size: 20px;
        cursor: pointer;
        z-index: 1;
        border-radius: 50%;
        transition: background 0.3s ease;
      }

      .arrow:hover {
        background: #111;
      }

      .arrow.left {
        left: 10px;
      }

      .arrow.right {
        right: 10px;
      }

      .product-details {
        flex: 1;
        min-width: 300px;
      }

      .product-details h2 {
        margin-top: 0;
        font-size: 28px;
        color: #222;
      }

      .product-details p {
        font-size: 16px;
        color: #444;
        margin-bottom: 12px;
      }

      .add-to-cart-btn {
        display: inline-block;
        margin-top: 20px;
        padding: 10px 20px;
        background: #111;
        color: white;
        border: none;
        cursor: pointer;
        font-size: 16px;
        border-radius: 6px;
        transition: background 0.3s ease;
      }

      .add-to-cart-btn:hover {
        background: #333;
      }

      .recommendations {
        max-width: 1100px;
        margin: 40px auto;
        padding: 20px;
        color: black;
      }

      .recommendations h3 {
        font-size: 22px;
        margin-bottom: 16px;
        color: black;
      }

      .rec-grid {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
      }

      .rec-card {
        flex: 1 1 200px;
        background: white;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 3px 12px rgba(0, 0, 0, 0.1);
        text-align: center;
        cursor: pointer;
        transition: transform 0.2s;
      }

      .rec-card:hover {
        transform: scale(1.03);
      }

      .rec-card img {
        max-width: 100%;
        height: 150px;
        object-fit: cover;
        border-radius: 6px;
        margin-bottom: 10px;
      }

      .rec-card h4 {
        margin: 10px 0 6px;
      }

      .rec-card p {
        font-size: 14px;
        color: #666;
      }
      .back-link {
        color: white;
      }

      @media (max-width: 768px) {
        .product-container {
          flex-direction: column;
          padding: 20px;
        }

        .rec-grid {
          flex-direction: column;
        }
        .product-info {
          flex: 1;
          display: flex;
          flex-direction: column;
          justify-content: flex-start;
        }
        .product-details {
          display: flex;
          flex-direction: column;
        }

        .product-meta {
          display: flex;
          flex-direction: column;
          gap: 10px;
        }
      }
      .product-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
      }
      .product-details {
        display: flex;
        flex-direction: column;
      }

      .product-meta {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .cart-actions {
        margin-top: 16px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .cart-actions input[type="number"] {
        width: 60px;
        padding: 6px;
        font-size: 14px;
        border-radius: 4px;
        border: 1px solid #ccc;
      }
    </style>
  </head>
  <body>
    <!-- NAVBAR -->
    <div
      class="topbar"
      style="
        background: #111;
        color: white;
        padding: 1rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
      "
    >
      <div class="navlogo">
        <a href="store.html" class="back-link">‚Üê Back to Store</a>
        <h2 style="margin: 0; font-size: 24px">Timeless Kenya</h2>
      </div>
      <div class="navlogoimg">
        <img src="/assets/321.gif" alt="logo" style="height: 60px" />
      </div>
      <div class="navlinks">
        <nav>
          <ul
            style="
              list-style: none;
              display: flex;
              gap: 20px;
              padding: 0;
              margin: 0;
            "
          >
            <li>
              <a
                href="/index.html"
                style="color: white; text-decoration: none; font-weight: 500"
                >Home</a
              >
            </li>
            <li>
              <a
                href="/html/store.html"
                style="color: white; text-decoration: none; font-weight: 500"
                >Store</a
              >
            </li>
            <li>
              <a
                href="/index.html"
                style="color: white; text-decoration: none; font-weight: 500"
                >Testimonials</a
              >
            </li>
            <li>
              <a
                href="/index.html"
                style="color: white; text-decoration: none; font-weight: 500"
                >Contact-Us</a
              >
            </li>
            <li>
              <a
                href="cart.html"
                style="
                  background: white;
                  color: #111;
                  padding: 8px 14px;
                  border-radius: 30px;
                  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                  text-decoration: none;
                  font-weight: 600;
                  display: flex;
                  align-items: center;
                  gap: 6px;
                "
              >
                üõí
                <span
                  style="
                    background: red;
                    color: white;
                    border-radius: 12px;
                    padding: 2px 8px;
                    font-size: 12px;
                    font-weight: bold;
                  "
                  id="cartCount"
                  >0</span
                >
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>

    <main>
      <div class="product-container" id="productView"></div>

      <div class="recommendations">
        <h3>You May Also Like</h3>
        <div class="rec-grid" id="recommendationGrid"></div>
      </div>
    </main>

    <script>
      let currentSlide = 0;
      let imageList = [];

      function changeSlide(direction) {
        currentSlide += direction;
        if (currentSlide < 0) currentSlide = imageList.length - 1;
        if (currentSlide >= imageList.length) currentSlide = 0;
        updateSlide();
      }

      function goToSlide(index) {
        currentSlide = index;
        updateSlide();
      }

      function updateSlide() {
        const mainImage = document.getElementById("mainImage");
        mainImage.src = imageList[currentSlide];

        document.querySelectorAll(".thumbnail-row img").forEach((img, i) => {
          img.classList.toggle("active", i === currentSlide);
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        const product = JSON.parse(localStorage.getItem("selectedProduct"));
        const allProducts = JSON.parse(localStorage.getItem("products")) || [];
        const container = document.getElementById("productView");
        const recGrid = document.getElementById("recommendationGrid");

        if (!product) {
          container.innerHTML =
            "<h2 style='text-align:center'>Product not found</h2>";
          return;
        }

        const images = product.images || [product.image];
        imageList = images;
        const mainImg = images[0];

        container.innerHTML = `
  <div class="product-images">
    <img id="mainImage" src="${mainImg}" alt="${
          product.name
        }" class="main-image" />
    <div class="thumbnail-row" id="thumbnailRow">
      ${images
        .map(
          (img, i) =>
            `<img src="${img}" class="${
              i === 0 ? "active" : ""
            }" onclick="switchImage('${img}', this)" />`
        )
        .join("")}
    </div>
  </div>
  <div class="product-details">
    <h2>${product.name}</h2>
    <p><strong>Price:</strong> KES ${product.price}</p>
    <p><strong>Description:</strong> ${product.description}</p>

    <div class="cart-actions">
      <label for="quantityInput"><strong>Quantity:</strong></label>
      <select id="quantityInput" style="margin-left: 10px;">
        ${[...Array(10)]
          .map((_, i) => `<option value="${i + 1}">${i + 1}</option>`)
          .join("")}
      </select>
      <br /><br />
      <button class="add-to-cart-btn" onclick="addToCart(${product.id})">
        Add to Cart
      </button>
    </div>
  </div>
`;

        const filtered = allProducts.filter((p) => p.id !== product.id);
        const random = filtered.sort(() => 0.5 - Math.random()).slice(0, 3);
        recGrid.innerHTML = random
          .map(
            (p) => `
            <div class="rec-card" onclick="viewProduct(${p.id})">
              <img src="${(p.images && p.images[0]) || p.image}" />
              <h4>${p.name}</h4>
              <p>KES ${p.price}</p>
            </div>
          `
          )
          .join("");

        updateCartCount();
      });

      function addToCart(productId) {
        const allProducts = JSON.parse(localStorage.getItem("products")) || [];
        const product = allProducts.find((p) => p.id == productId);
        if (!product) return;

        const quantity = parseInt(
          document.getElementById("quantityInput")?.value || 1
        );

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find((item) => item.id === product.id);
        if (existing) {
          existing.quantity += quantity;
        } else {
          cart.push({ ...product, quantity });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartCount();
        animateCart();
        alert("‚úÖ Product added to cart!");
      }

      function updateCartCount() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById("cartCount").textContent = totalItems;
      }

      function animateCart() {
        const cartIcon = document.getElementById("cartIcon");
        cartIcon.classList.add("animate");
        setTimeout(() => cartIcon.classList.remove("animate"), 400);
      }

      function viewProduct(id) {
        const allProducts = JSON.parse(localStorage.getItem("products")) || [];
        const product = allProducts.find((p) => p.id == id);
        if (product) {
          localStorage.setItem("selectedProduct", JSON.stringify(product));
          window.location.href = "product.html";
        }
      }
    </script>
  </body>
</html>
